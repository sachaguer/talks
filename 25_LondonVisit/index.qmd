---
title: "Constraining cosmology with weak gravitational lensing"
subtitle: "lessons learned from the Ultraviolet Near-Infrared Optical Northern Survey (UNIONS)"
author: "Sacha Guerrini, RHU seminar, 8th September 2025"
date-meta: "October 8, 2025"
image: images/unions.jpg
description: |
   Talk given at the Royal Holoway University Seminar during a visit in London.
format:
   revealjs: 
    theme: default
    highlight-style: monokai
    slide-number: true
    countExcluded: true
    chalkboard:
        buttons: false
    preview-links: auto
    footer: |
        <div class="footer-logos">
        <div class="logo-cea">
        <img src="images/logo_cea.jpeg" alt="CEA" />
        </div>
        <div class="logo-crop">
        <img src="images/cosmostat_logo.jpeg" alt="CosmoStat" />
        </div>
        <div class="logo-white-bg">
        <img src="images/unions_logo.png" alt="UNIONS" />
        </div>
        </div>
    title-slide-attributes:
      data-background-image: "images/Perseus_euclid.jpg"
      data-background-size: cover
      data-background-position: center
    css: styles.css
---

## Cosmological context: $\Lambda$CDM{style="font-size: 20px;"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![Credit: NAOJ](images/cosmology.jpg)


\begin{align}
\left.
\begin{array}{cc}
H_0 & \text{Expansion rate}\\ 
\Omega_m & \text{Matter density}\\ 
\Omega_b & \text{Baryon density}\\ 
\sigma_8 & \text{Clumpiness}\\ 
w & \text{EoS of dark energy}
\end{array}
\right\} \text{Constrained using Bayesian inference}
\end{align}


## Cosmological probes and history of the Universe{style="font-size: 20px;"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![Credit: NAOJ](images/cosmology.jpg)

<div class="fragment">
<div class="box-cmb"></div>
<div class="green-contour">
 <img src="images/cmb.jpg" alt="CMB" width="180px">
 <div style="
    text-align: center;
    margin-top: 5px;
    color: black;
    position: absolute;
    bottom: 235px;
    left: 100px
 ">CMB</div>
</div>
</div>

<div class="fragment">
<div class="box-reionization"></div>
<div class="yellow-contour">
 <img src="images/radio.jpeg" alt="21cm" width="250px" />
 <div style="
    text-align: center;
    margin-top: 5px;
    color: black;
    position: absolute;
    bottom: 240px;
    left: 400px
 ">21cm/intensity mapping</div>
</div>
</div>

<div class="fragment">
<div class="box-lss"></div> 
 <div class="gc-contour">
 <img src="images/gc.jpeg" alt="galaxy clustering" width="180px" />
 <div style="
    text-align: center;
    margin-top: 5px;
    color: black;
    position: absolute;
    bottom: 350px;
    left: 1100px
 ">Galaxy clustering</div>
 </div>
</div>

<div class="fragment">
<div class="wl-contour">
 <img src="images/wl.jpg" alt="weak lensing" width="250px" />
 <div style="
    text-align: center;
    margin-top: 5px;
    color: black;
    position: absolute;
    bottom: 150px;
    left: 1060px
 ">Weak lensing</div>
 </div>
</div>


## {background-video="images/grav_lensing.mp4"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

<div style="
    text-align: center;
    margin-top: 5px;
    color: white;
    position: absolute;
    bottom: 50px;
    left: -100px
">
Credit: RAS
</div>

## Weak gravitational lensing

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![Credit: ESA](images/weak_lensing.png)

- Percent-level effect
- Polluted by shape noise
- Requires a large number of galaxies

## The Ultraviolet Near-Infrared Optical Northern Survey ([Gwyn et al., 2025](https://arxiv.org/abs/2503.13783)){style="font-size: 24px;"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![](images/unions.jpg)

<div style="
   text-align: center;
   margin-top: 5px;
   color: black;
   position: absolute;
   bottom: 250px;
   left: 50px;
">$r$, $u$ bands</div>

<div style="
   text-align: center;
   margin-top: 5px;
   color: black;
   position: absolute;
   bottom: 250px;
   left: 500px;
">$i$ band</div>

<div style="
   text-align: center;
   margin-top: 5px;
   color: black;
   position: absolute;
   bottom: 260px;
   left: 920px;
">$g$, $z$ bands</div>

## The landscape of lensing surveys{style="font-size: 30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![](images/landscape_lensing.png){.absolute right=-100 bottom=100 height=500}

:::: {.columns}

::: {.column width="40%"}
Technical specifications of UNIONS:

- Target area: $\sim 5,000$ deg$^2$
- Depth: 24.5 ($r$-band)
- Seeing: $\sim 0.69"$ ($r$-band)
- Processing with ShapePipe ([Farrens et al., 2022](https://arxiv.org/abs/2206.14689))
- $\sim 100$ million galaxies 
:::

::::

## Cosmology with cosmic shear

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![Credit: S. Farrens](images/cosmic_shear_pipeline.png)

::: {.fragment}
<div class="first-part"></div>
<div style="
   text-align: center;
   margin-top: 5px;
   color: rgb(240, 20, 20);
   font-size: 24px;
   position: absolute;
   bottom: 280px;
   left: 870px;
   width: 200px;
">I\. PSF diagnostics</div>
:::

::: {.fragment}
<div class="second-part"></div>
<div style="
   text-align: center;
   margin-top: 5px;
   color: rgb(14, 170, 14);
   font-size: 24px;
   position: absolute;
   bottom: 180px;
   left: -168px;
   width: 200px;
">II\. Cosmic shear with 2pt-statistics</div>
:::

::: {.fragment}
<div style="
   text-align: center;
   margin-top: 5px;
   color: rgb(38, 65, 238);
   font-size: 24px;
   position: absolute;
   bottom: 140px;
   left: -168px;
   width: 200px;
">III\. And beyond</div>
:::

## I\. PSF diagnostics

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

<div style="
position: absolute;
left: 50%;
top: 30%;
transform: translate(-50%, -50%);
text-align: center;
width:800px;
height: 200px;
overflow: hidden;
">

```{r, engine = 'tikz'}
\usetikzlibrary{positioning} 
\usetikzlibrary{calc}

\begin{tikzpicture}[baseline=(current bounding box.center)]
  % Define the terms as nodes
  \definecolor{mygreen}{rgb}{0.05, 0.68, 0.05}

  \node[text=mygreen] (term1) {Intrinsic ellipticity};
  \node[right=1.5cm of term1, text=red] (term2) {Multiplicative bias};
  \node[right=1.5cm of term2, text=red] (term3) {Additive bias};
  
  % Full equation with a box around epsilon^s
  \node[above=1.5 cm of term2] (eq) {
    $e = 
      \tikz[baseline=(es.base)] \node[draw=mygreen, rectangle] (es) {$\epsilon^\mathrm{s}$}; 
      + (1 + 
      \tikz[baseline=(m.base)] \node[draw=red, rectangle] (m) {m};
      )\gamma^\mathrm{true} +
      \tikz[baseline=(c.base)] \node[draw=red, rectangle] (c) {c};$
  };

  \coordinate (left-arrow) at ($(eq.south) + (-1.5cm,0)$);
  \coordinate (right-arrow) at ($(eq.south) + (2.3cm,0)$);
  \coordinate (middle-arrow) at ($(eq.south) + (0.3cm,0)$);

  % Arrows from labels to equation terms
  \draw[->, mygreen] (term1.north) -- (left-arrow);
  \draw[->, red] (term2.north) -- (middle-arrow);
  \draw[->, red] (term3.north) -- (right-arrow);
\end{tikzpicture}
```


</div>

<div style="
   position: absolute;
   bottom: 10px;
   left: 150px
">
<img src="images/mandelbaum_2018.png" alt="galaxy clustering" width="1000px" />
</div>
<div style="
   font-size: 16pt;
   height: 60px;
   width: 250px;
   position: absolute;
   left: 900px;
   bottom: 0px;
">Credit: Mandelbaum (2018)</div>

## 

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![](images/psf_size.gif)

![](images/psf_anisotropy.gif)

<div style="
   font-size: 24pt;
   height: 60px;
   width: 250px;
   position: absolute;
   left: 100px;
   bottom: 400px;
">PSF size error</div>

<div style="
   font-size: 24pt;
   height: 60px;
   width: 250px;
   position: absolute;
   left: 100px;
   bottom: 50px;
">PSF anisotropy</div>

<div style="
   font-size: 16pt;
   height: 60px;
   width: 250px;
   position: absolute;
   left: 900px;
   bottom: 0px;
">Credit: A. Navarro</div>

## {background-image="images/Perseus_euclid.jpg" background-size="cover"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

```{r, engine='tikz', dev='svg', fig.width=16, fig.height=9}
\begin{tikzpicture}[x=1cm, y=1cm, scale=1]
  % Fix bounding box to slide aspect ratio (16:9, e.g. 16x9 cm)
  \useasboundingbox (0,0) rectangle (16,9);

   \draw[blue, thick, dashed, draw opacity=0.05] (0,0) rectangle (16,9);
  % Example coordinates (you adjust until circles match galaxies)
  \node[circle, draw=red, thick, minimum size=0.4cm] (A) at (8.1,6.8) {};
  \node[circle, draw=red, thick, minimum size=0.4cm] (B) at (11.5, 5.1) {};
  \node[circle, draw=green, thick, minimum size=0.5cm] (C) at (2.3,3) {};
  \node[circle, draw=green, thick, minimum size=0.7cm] (D) at (9.2,2.1) {};

  % Add text anchored above the nodes
\node[above, text=red] at (A.north) {Star};
\node[above, text=red] at (B.north) {Star};
\node[below, text=green] at (C.south) {Galaxy};
\node[below, text=green] at (D.south) {Galaxy};

  % Arrows
  \draw[<->, red, thick] (A) -- (B) node[midway, above, text=white] {$\rho(\theta)$};
  \draw[<->, orange, thick] (A) -- (D) node[midway, left, text=white] {$\tau(\theta)$};
  \draw[<->, green, thick] (C) -- (D) node[midway, below, text=white] {$\xi_\pm(\theta)$};
\end{tikzpicture}
```

## Galaxy-PSF correlations{style="font-size: 30px; width: 120%; left: -50px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

PSF error model: $\delta \boldsymbol{e}^\mathrm{sys}_\mathrm{PSF} = \alpha \underbrace{\boldsymbol{e}_\mathrm{PSF}}_{\text{Leakage}} + \beta \underbrace{(\boldsymbol{e}_* - \boldsymbol{e}_\mathrm{PSF})}_{\text{Ellipticity error}} + \eta \underbrace{\boldsymbol{e}_\mathrm{PSF} \left(\frac{T_* - T_\mathrm{PSF}}{T_*} \right)}_{\text{Size error}}$. $\alpha$, $\beta$ and $\eta$ free parameters.

\begin{equation}
    \left(
        \begin{array}{l}
            \tau_{0,1} \\ \tau_{2,1} \\ \tau_{5, 1} \\ \vdots \\
            \tau_{0, n} \\ \tau_{2, n} \\ \tau_{5, n}
        \end{array}
    \right)
    =
    \left(
      \begin{array}{llllll}
        \rho_{0, 1} & \rho_{2, 1} & \rho_{5, 1} \\
        \rho_{2, 1} & \rho_{1, 1} & \rho_{4, 1} \\
        \rho_{5, 1} & \rho_{4, 1} & \rho_{3, 1} \\
               & \ddots &        \\
        \rho_{0, n} & \rho_{2, n} & \rho_{5, n} \\
        \rho_{2, n} & \rho_{1, n} & \rho_{4, n} \\
        \rho_{5, n} & \rho_{4, n} & \rho_{3, n} \\
      \end{array}
    \right)
    \left(
      \begin{array}{l}
        \alpha \\ \beta \\ \eta \\
      \end{array}
    \right)
    \label{eq:tau_matrix}
\end{equation}

Systematic error: $\xi^\mathrm{sys}_\mathrm{PSF} = \alpha^2 \rho_0 + \beta^2 \rho_1 + \eta^2 \rho_3 + 2 \alpha \beta \rho_2 + 2 \alpha \eta \rho_5 + 2 \beta \eta \rho_4$

<div style="
   position: absolute;
   right: 8%;
   bottom: 45%
">Constrain with MCMC</div>

## Semi-analytical covariance ([Guerrini et al. (2025)](https://www.aanda.org/articles/aa/full_html/2025/08/aa53512-24/aa53512-24.html)){style="font-size: 30px;"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

Analytical: based on analytical expressions of the covariance

Semi: No theoretical predictions of the $\rho$- and $\tau$-statistics. Use measurements on data.

![](images/semi_analytical_cov.png)

## Prediction of the systematic additive bias{style="font-size: 30px;"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![](images/ratio_xi_sys_xi.png)

## Estimation of PSF parameters{style="font-size: 30px;"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![](images/contours_tau_stat.png)

<div style="
   position: absolute;
   right: 0%;
   bottom: 50%;
">
Can provide priors for cosmological analysis!
</div>

## PSF systematics: Take-home messages{style="font-size: 30px;"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

- PSF systematics are essential to understand to perform cosmic shear analysis.
- $\rho$- and $\tau$-statistics are powerful tools to estimate the bias to the 2PCF.
- Semi-analytical covariance ([Guerrini+2025](https://www.aanda.org/articles/aa/full_html/2025/08/aa53512-24/aa53512-24.html)) can speed up comparisons between catalogs.

![](images/visual_inspection.png)

## II\. Cosmic shear with 2pt statistics

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![](images/cosmic_shear_team.png)

<div style="
   position: absolute;
   bottom: 0%;
   right: -20%;
   font-size: 30px;
">and other contributors...</div>

## Analysis details{style="font-size: 30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

:::: {.columns}

::: {.column width=50%}

- Theoretical prediction: CAMB
- Non-linear power spectrum: HMCode2020
- Shear calibration with MetaCalibration.
- Residual multiplicative bias estimated from image simulations. (Hervas Peter et al., in prep.)
- Cosmology pipeline with [CosmoSIS](https://cosmosis.readthedocs.io/en/latest/).
- Analysis in real space (Goh et al., in prep.) and harmonic space (Guerrini et al., in prep.).
- PSF systematics accounted for in the inference.

:::

::: {.column width=50%}
![Real CFHT exposure](images/real_cfht.png){height=220px}

![Simulated exposure](images/sim_cfht.png){height=220px}

:::

::::

## B-modes systematics{style="font-size: 30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

:::: {.columns}

::: {.column width=70%}
Spin-2 shear fields can be decomposed into **E-modes**, containing the vast majority of lensing information, and **B-modes**, which are a probe of systematics at UNIONS noise levels.

In the presence of masking, some **ambiguous** modes usually cannot be cleanly attributed to E or B.

We use three B-mode approaches: pure correlation functions, COSEBIS, and pseudo-$C_\ell$.
:::

::: {.column width=30%}
![Credit: BICEP2 Collaboration](images/e_b_modes.png)
:::

::::

## Pure B-mode correlation functions{style="font-size:24px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

$$
\xi_+^{E/B}(\vartheta) = \frac 1 2 \left[\xi_+(\vartheta) \pm \xi_-(\vartheta) + \int_\vartheta^{\vartheta_\mathrm{max}}\frac{\mathrm{d}\theta}{\theta} \xi_-(\theta) \left(4 - \frac{12\vartheta^2}{\theta^2} \right) \right] - \frac 1 2 \underbrace{[S_+(\vartheta) \pm S_-(\vartheta)]}_{\text{Integrals of $\xi_\pm$ with filter functions}}
$$ 

![Credit: C. Daley](images/b_mode_pure_functions.png){height=350px}

B-modes on small scale ($\sim 3'$ in $\xi_+$ and $\sim 30'$ in $\xi_-$); large scales are ok.

## B-modes with COSEBIS{style="font-size:30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![](images/cosebis_scale_cut.png)

Pure functions and COSEBIS tell the same story.

## B-modes in harmonic space{style="font-size:30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

::: {.center}
![](images/b_modes_cl.png){height=450px}
:::

B-modes on the smallest scales. Lower significance after removing the smallest objects from the catalogue. Data points and errorbars obtained with NaMaster.

## Redshift distributions{style="font-size:30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

:::: {.columns}

::: {.column width=40%}
Redshift distribution estimated using self-organizing map (SOMs).

Three blinded reshift distribution produced to avoid confirmation bias. We make analysis choices given the output on the three blinds.
:::

::: {.column width=60%}
![Credit: Anna Wittje](images/n_z.png)
:::

::::

## Covariance (real space){style="font-size:30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

:::: {.columns}

::: {.column width=70%}
![](images/treecorr_cov_real_space.png){height=250px}
![](images/covariance_real_space.png){height=250px}
:::
::: {.column width=30%}
Covariance estimated with CosmoCov and validated against data-drive jackknife and GLASS simulations (not shown here).

Parameters marginalized over in inference:

- PSF systematics
- Intrinsic alignment
- multiplicative bias
- $n(z)$ bias
:::
::::

## Covariance (harmonic space){style="font-size:30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

:::: {.columns}

::: {.column width=70%}
![](images/corr_matrix_comparison.png){height=250px}
![](images/corr_matrix_comparison_non_gaussian.png){height=250px}
:::

::: {.column width=30%}
Gaussian covariance accounting for mask mode-coupling with iNKA (Namaster). Validation against OneCovariance (theory code) and GLASS mocks.

Agreement between the error bars at the $10\%$ level
:::

::::

## Inference{style="font-size:30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

<div style="height: 500px">
:::: {.columns}

::: {.column width=50%}
Real space $\xi_\pm(\vartheta)$

![](images/contours_s8_omegam_xi.png){height=400px}
:::
::: {.column width=50%}
Harmonic space $C_\ell$

![](images/contours_s8_omegam.png){height=400px}
:::

::::
</div>

$\sim 2\times$ larger than DES, KiDS or HSC.

Non-tomographic analysis significantly reduces constraining power.


## III\. Beyond 2pt statistics

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

::: {.center}
![](images/flamingo.png){height=550px}
:::

## Higher-order statistics{style="font-size:30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

:::: {.columns}

::: {.column width=50%}
The overdensity field is not a Gaussian field at late times.

How can we capture the more information from the shear field?

Craft summary statistics that capture **non-Gaussian information** from the field.
:::

::: {.column width=50%}
![[Euclid Collaboration+2023](https://arxiv.org/abs/2301.12890)](images/euclid_hos.png)
:::

::::

## Same methodology than 2pt?

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

:::: {.columns}

::: {.column width=50%}
- Does the Gaussianity of the likelihood still hold?
- Do we have a theorerical model of the higher-order summary?
- Do we know how the higher-order summary respond to systematics?
:::
::: {.column width=50%}
$$
p(\theta | x) \propto \underbrace{p(x|\theta)}_\text{Likelihood} p(\theta)
$$
:::

::::

## Implicit Likelihood Inference (also known as SBI)

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

```{r, engine='tikz'}
\begin{tikzpicture}[scale=1.2, font=\small, node distance={40mm}, thick, main/.style = {draw, rectangle, minimum size=7mm, text centered}, label/.style = {align=center, text width=30mm}]
   \pgfmathsetmacro{\height}{1.8}
   \node[main] (Parameters) at (-9,\height){Parameters $\theta$}; 
   
   \node (Observation) at (-9,-\height){\includegraphics[width=30mm]{images/patches_on_sphere.png}};
   \node[label, anchor=north] at (Observation.south) {UNIONS-like Observation $x$};
   
   \node (Compressed) at (-5,-\height){\includegraphics[width=30mm]{images/NN.png}};
   \node[label, anchor=north] at (Compressed.south) {Compressed data $t = \mathcal{F}(x)$};
   \node[label, anchor=south] at (Compressed.north) {Neural Network or Summary Statistic};
   
   \node (NDE) at (0,0){\includegraphics[width=30mm]{images/NN.png}};
   \node[label, anchor=south] at (NDE.north) {Normalizing Flow (NLE, NPE)};
   
   \node[main, text width=25mm] (Posterior) [right of=NDE]{Posterior $p(\theta | t_{obs}, M)$}; 
   \node[main] (UNIONS) at (3.34,-\height){UNIONS data}; 
   % \node[main, below of = Posterior] (UNIONS) {UNIONS data}; 
   
   \draw[->] (Parameters.east) -- (-2.5,\height) -- (-2.5, 0) -- (NDE.west);
   \draw[->] (Observation.east) -- (Compressed.west);
   \draw[->] (Parameters.south) -- (Observation.north) node [pos=0.5, right] {Simulation} ;
   \draw[->] (Compressed.east) -- (-2.5,-\height) -- (-2.5, 0) -- (NDE.west);
   \draw[->] (NDE.east) -- (Posterior.west);
   \draw[->] (UNIONS.north) -- (Posterior.south);
\end{tikzpicture} 
```

## Normalizing Flows

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

:::: {.columns}

::: {.column width=40%}
Apply several layers of a one-to-one map to simple distribution to match a more complex one.

Alleviates the problem of the unknown likelihood.
:::

::: {.column width=60%}
![](images/NDE.gif)
:::

::::

## UNIONS forward model

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

```{r, engine='tikz'}
\begin{tikzpicture}[scale=1, font=\small, node distance={40mm}, thick, main/.style = {draw, rectangle, minimum size=7mm, text centered}, label/.style = {align=center, text width=30mm}]
   
   \node (Shear) at (-3,0){\includegraphics[width=30mm]{images/gamma1_fullsky.png}};

   \node (GowerStreet) at (-12, 0){\includegraphics[width=60mm]{images/gower_street.png}} ;
   \node[label, anchor=south] at (GowerStreet.north) {GowerStreet simulations};

   \node (IA) at (-7, 2.5){\includegraphics[width=20mm]{images/intrinsic_alignment.jpg}};
   \node[label, anchor=south] at (IA.north) {Intrinsic Alignment};

   \node (PSF) at (-7, -2.5){\includegraphics[width=20mm]{images/PSF.png}};
   \node[label, anchor=north] at (PSF.south) {Point-Spread Function};

   \node (nz) at (1.5, 1.5){\includegraphics[width=30mm]{images/n_z.png}};
   \node[label, anchor=south] at (nz.north) {Redshift distribution};

   \node (mask) at (1.5, -1.5){\includegraphics[width=30mm]{images/patches_on_sphere.png}};
   \node[label, anchor=north] at (mask.south) {Footprint};

   \node (observation) at (6, 0) {\includegraphics[width=60mm]{images/shear_map_e1.png}};
   \node[label, anchor=north] at (observation.south) {Observation};

   
   \draw[->] (GowerStreet.east) -- node[midway, above]{Ray-tracing/Higher-order effects} (Shear.west);

   \draw[->] (IA.east) -- (-3, 2.5) -- (Shear.north);

   \draw[->] (PSF.east) -- (-3, -2.5) -- (Shear.south);

   \draw[->] (Shear.east) -- (observation.west);
\end{tikzpicture} 
```

Available on [GitHub](https://github.com/sachaguer)

## [JaxILI](https://github.com/sachaguer/jaxili), a pipeline for Implicit Likelihood Inference{style="font-size: 30px" auto-animate="true"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

``` {.python code-line-numbers="4-5|7-9"}
checkpoint_path = ... #Choose the checkpoint path
checkpoint_path = os.path.abspath(checkpoint_path) #Beware, this should be an absolute path.

inference = NPE()
inference = inference.append_simulations(theta, x)

metrics, density_estimator = inference.train(
    checkpoint_path=checkpoint_path,
)
```

## [JaxILI](https://github.com/sachaguer/jaxili), a pipeline for Implicit Likelihood Inference{style="font-size: 30px" auto-animate="true"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

``` python
checkpoint_path = ... #Choose the checkpoint path
checkpoint_path = os.path.abspath(checkpoint_path) #Beware, this should be an absolute path.

compressor = Compressor(
    model_class=model_class,
    model_hparams=model_hparams,
)

compressor = compressor.append_simulations(theta=theta, x=x)

metrics, MSE_compression_function = compressor.train(
    checkpoint_path=checkpoint_path
)

inference = NPE()
inference = inference.append_simulations(theta, x)

metrics, density_estimator = inference.train(
    checkpoint_path=checkpoint_path,
)
```

## [JaxILI](https://github.com/sachaguer/jaxili) on a cosmological toy model{style="font-size: 30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

Cosmological parameters: $A_\mathrm{s}$, $n_\mathrm{s}$, $f_\mathrm{NL}$

![Go [here](https://sachaguer.github.io/LesHouches2025/site/BBKS_FLI.html) for more](images/toy_model.png)

Goal: Obtain constraints on the cosmological parameters using pixel level information.

## [JaxILI](https://github.com/sachaguer/jaxili) on a cosmological toy model{style="font-size: 30px" auto-animate="true"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

Cosmological parameters: $A_\mathrm{s}$, $n_\mathrm{s}$, $f_\mathrm{NL}$

![](images/contours_bbks.png)

## Application to UNIONS data{style="font-size=30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

:::: {.columns}

::: {.column width=40%}
- CNN optimal compression
- Extract information at the pixel level.
- Cut the footprint in patches.
:::

::: {.column width=60%}
![Credit: M. Maupas](images/patches.png)
:::
::::

## Application to UNIONS data{style="font-size=30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

:::: {.columns}

::: {.column width=50%}
![](images/cnn_narrow_prior.png)
:::
::: {.column width=50%}
![](images/cnn_wide_prior.png)
:::
::::

## Conclusions

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

- First cosmic shear cosmology results from UNIONS are incoming!
- Allowed to develop tools used in *Euclid* cosmic shear analysis/validation of the data.
- Exploring advanced Bayesian inference methods to extract more information from the available datasets.

## Extra material: UNIONS multi-band coverage{visibility="uncounted" style="font-size: 30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![](images/unions_multi_band.png)

## Extra material: MetaCalibration{visibility="uncounted" style="font-size: 30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![Credit: F. Hervas Peters](images/metacalibration.png)

## Extra material: Scale cuts{visibility="uncounted" style="font-size: 30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![](images/scale_cut_real_space.png)

## Extra material: Best-fit{visibility="uncounted" style="font-size: 30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![](images/beest_fit_real_space.png)

## Extra material: $S_8$ constraints{visibility="uncounted" style="font-size: 30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![](images/s8_whisker.png)

## Extra material: real space vs harmonic space{visibility="uncounted" style="font-size: 30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![](images/diff_real_vs_harmonic.png)

## Extra material: MSE compression{visibility="uncounted" style="font-size: 30px"}

::: {.footer}
S. Guerrini, 08/10/2025, RHUL
:::

![](images/compression_output.png)

